<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sim Life - Damian Kita</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap');

        :root {
            --sims-green: #7cfc00;
            --sims-blue: #00bfff;
            --bg-color: #f0f2f5;
            --panel-bg: #ffffff;
            --text-main: #1f2937;
            --text-muted: #6b7280;
            --border-color: #e5e7eb;
            --grid-color: #e5e7eb;
        }

        /* Dark Mode variables */
        body.dark {
            --bg-color: #111827;
            --panel-bg: #1f2937;
            --text-main: #f9fafb;
            --text-muted: #9ca3af;
            --border-color: #374151;
            --grid-color: #374151;
        }

        body {
            font-family: 'Outfit', sans-serif;
            background: var(--bg-color);
            color: var(--text-main);
            touch-action: manipulation;
            overflow: hidden;
            transition: background 0.3s, color 0.3s;
        }

        .plumob {
            width: 40px;
            height: 40px;
            background: var(--sims-green);
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
            animation: float 2s ease-in-out infinite, rotate 4s linear infinite;
            filter: drop-shadow(0 0 10px rgba(124, 252, 0, 0.5));
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes rotate {
            from { transform: rotateY(0deg); }
            to { transform: rotateY(360deg); }
        }

        .stat-bar {
            height: 10px;
            transition: width 0.5s ease-in-out, background-color 0.3s;
        }

        .game-screen {
            background-image: radial-gradient(var(--grid-color) 1px, transparent 1px);
            background-size: 20px 20px;
            background-color: var(--bg-color);
        }

        .btn-action {
            transition: all 0.2s;
            -webkit-tap-highlight-color: transparent;
        }

        .btn-action:active {
            transform: scale(0.95);
        }

        .modal-overlay {
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
        }

        .bg-panel { background-color: var(--panel-bg); }
        .border-panel { border-color: var(--border-color); }
        .text-main { color: var(--text-main); }
        .text-muted { color: var(--text-muted); }
    </style>
</head>
<body class="h-screen flex flex-col dark">

    <!-- Header Stats -->
    <header class="bg-panel shadow-md p-4 flex justify-between items-center z-10 border-panel border-b">
        <div class="flex items-center gap-3">
            <div class="plumob"></div>
            <div>
                <h1 class="font-bold text-lg leading-none text-main">Sim Life</h1>
                <p class="text-xs text-muted">Autor: Damian Kita</p>
            </div>
        </div>
        <div class="flex items-center gap-2 md:gap-4">
            <div class="text-right">
                <div class="text-xl font-bold text-green-500" id="money-display">100 ¬ß</div>
                <div class="text-[10px] uppercase tracking-wider text-muted font-bold" id="time-display">Poniedzia≈Çek, 08:00</div>
            </div>
            
            <div class="flex gap-1 md:gap-2">
                <button id="theme-toggle" class="p-2 bg-gray-100 dark:bg-gray-700 rounded-full text-muted hover:text-main transition-colors">
                    <svg id="theme-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"/></svg>
                </button>
                <button id="audio-toggle" class="p-2 bg-gray-100 dark:bg-gray-700 rounded-full text-muted hover:text-main transition-colors">
                    <svg id="music-on" class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Game Area -->
    <main class="flex-1 relative game-screen overflow-hidden flex flex-col md:flex-row">
        
        <!-- Character / Home View -->
        <div class="flex-1 relative flex items-center justify-center p-4">
            <div id="character-container" class="relative text-center">
                <div id="character-sprite" class="text-8xl mb-4 transition-all duration-500 transform scale-100">üßç‚Äç‚ôÇÔ∏è</div>
                <div id="speech-bubble" class="absolute -top-16 left-1/2 -translate-x-1/2 bg-panel p-3 rounded-2xl shadow-xl border border-panel opacity-0 transition-opacity">
                    <span id="bubble-text" class="text-sm font-semibold text-main">G≈Çodny jestem!</span>
                </div>
            </div>
            
            <!-- Home Elements -->
            <div id="room-items" class="absolute inset-0 pointer-events-none flex flex-wrap content-start p-10 gap-8 opacity-40">
                <!-- Items will appear here when bought -->
            </div>
        </div>

        <!-- Dashboard / Controls -->
        <div class="w-full md:w-80 bg-panel border-t md:border-t-0 md:border-l border-panel p-4 shadow-2xl flex flex-col gap-6 overflow-y-auto">
            
            <!-- Needs -->
            <section>
                <h2 class="text-xs font-bold uppercase text-muted mb-3 tracking-widest">Potrzeby</h2>
                <div class="space-y-4">
                    <div class="need-item">
                        <div class="flex justify-between text-xs mb-1 text-main">
                            <span>G≈Ç√≥d</span>
                            <span id="val-hunger">100%</span>
                        </div>
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                            <div id="bar-hunger" class="stat-bar bg-orange-400 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="need-item">
                        <div class="flex justify-between text-xs mb-1 text-main">
                            <span>Energia</span>
                            <span id="val-energy">100%</span>
                        </div>
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                            <div id="bar-energy" class="stat-bar bg-yellow-400 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="need-item">
                        <div class="flex justify-between text-xs mb-1 text-main">
                            <span>Higiena</span>
                            <span id="val-hygiene">100%</span>
                        </div>
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                            <div id="bar-hygiene" class="stat-bar bg-blue-400 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="need-item">
                        <div class="flex justify-between text-xs mb-1 text-main">
                            <span>Zabawa</span>
                            <span id="val-fun">100%</span>
                        </div>
                        <div class="w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2">
                            <div id="bar-fun" class="stat-bar bg-pink-400 rounded-full" style="width: 100%"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Actions -->
            <section>
                <h2 class="text-xs font-bold uppercase text-muted mb-3 tracking-widest">Dzia≈Çania</h2>
                <div class="grid grid-cols-2 gap-2">
                    <button onclick="game.performAction('eat')" class="btn-action bg-orange-50 dark:bg-orange-900/20 p-3 rounded-xl border border-orange-100 dark:border-orange-800/30 hover:bg-orange-100 dark:hover:bg-orange-800/40 text-sm flex flex-col items-center text-main">
                        <span class="text-xl">üçï</span> Jedz
                    </button>
                    <button onclick="game.performAction('sleep')" class="btn-action bg-yellow-50 dark:bg-yellow-900/20 p-3 rounded-xl border border-yellow-100 dark:border-yellow-800/30 hover:bg-yellow-100 dark:hover:bg-yellow-800/40 text-sm flex flex-col items-center text-main">
                        <span class="text-xl">üí§</span> ≈öpij
                    </button>
                    <button onclick="game.performAction('shower')" class="btn-action bg-blue-50 dark:bg-blue-900/20 p-3 rounded-xl border border-blue-100 dark:border-blue-800/30 hover:bg-blue-100 dark:hover:bg-blue-800/40 text-sm flex flex-col items-center text-main">
                        <span class="text-xl">üöø</span> Prysznic
                    </button>
                    <button onclick="game.performAction('work')" class="btn-action bg-green-50 dark:bg-green-900/20 p-3 rounded-xl border border-green-100 dark:border-green-800/30 hover:bg-green-100 dark:hover:bg-green-800/40 text-sm flex flex-col items-center text-main">
                        <span class="text-xl">üíº</span> Pracuj
                    </button>
                </div>
            </section>

            <!-- Shop -->
            <section class="mt-auto pt-4 border-t border-panel">
                <button onclick="ui.toggleShop()" class="w-full bg-indigo-600 text-white py-3 rounded-xl font-bold shadow-lg shadow-indigo-200 dark:shadow-none hover:bg-indigo-700 active:scale-95 transition-all">
                    üõí Sklep z meblami
                </button>
            </section>
        </div>
    </main>

    <!-- Shop Modal -->
    <div id="shop-modal" class="hidden fixed inset-0 z-50 flex items-center justify-center p-4">
        <div class="modal-overlay absolute inset-0" onclick="ui.toggleShop()"></div>
        <div class="bg-panel w-full max-w-md rounded-3xl shadow-2xl relative z-10 overflow-hidden border border-panel">
            <div class="p-6 border-b border-panel flex justify-between items-center">
                <h2 class="text-2xl font-bold text-main">Katalog mebli</h2>
                <button onclick="ui.toggleShop()" class="text-muted hover:text-main">‚úï</button>
            </div>
            <div class="p-4 max-h-[60vh] overflow-y-auto space-y-3" id="shop-items">
                <!-- Shop items dynamic -->
            </div>
            <div class="p-6 bg-gray-50 dark:bg-gray-800/50 text-center text-xs text-muted">
                Wspieraj lokalnych tw√≥rc√≥w - Damian Kita
            </div>
        </div>
    </div>

    <!-- Info Footer -->
    <footer class="bg-panel border-t border-panel p-2 text-center text-[10px] text-muted transition-colors">
        &copy; 2024 Symulator ≈ªycia. Autor: <a href="https://linktr.ee/kitadamian" target="_blank" class="underline hover:text-indigo-600">Damian Kita</a>
    </footer>

    <audio id="bg-music" loop>
        <source src="https://actions.google.com/sounds/v1/water/showering.ogg" type="audio/ogg">
    </audio>

    <script>
        // Constants & Data
        const SHOP_ITEMS = [
            { id: 'tv', name: 'Telewizor Plazmowy', icon: 'üì∫', price: 500 },
            { id: 'bed', name: 'Luksusowe ≈Å√≥≈ºko', icon: 'üõèÔ∏è', price: 800 },
            { id: 'fridge', name: 'Lod√≥wka Smart', icon: 'üßä', price: 600 },
            { id: 'pc', name: 'Komputer Gamingowy', icon: 'üñ•Ô∏è', price: 1200 }
        ];

        // Sound Engine
        const Sound = {
            ctx: null,
            init() {
                if (!this.ctx) this.ctx = new (window.AudioContext || window.webkitAudioContext)();
            },
            playTone(freq, duration, type = 'sine') {
                if (!this.ctx) return;
                const osc = this.ctx.createOscillator();
                const gain = this.ctx.createGain();
                osc.type = type;
                osc.frequency.setValueAtTime(freq, this.ctx.currentTime);
                gain.gain.setValueAtTime(0.1, this.ctx.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.0001, this.ctx.currentTime + duration);
                osc.connect(gain);
                gain.connect(this.ctx.destination);
                osc.start();
                osc.stop(this.ctx.currentTime + duration);
            },
            click() { this.playTone(600, 0.1, 'square'); },
            buy() { this.playTone(880, 0.3); setTimeout(() => this.playTone(1320, 0.3), 100); },
            sad() { this.playTone(200, 0.5); },
            happy() { this.playTone(440, 0.2); setTimeout(() => this.playTone(660, 0.2), 50); }
        };

        // Game State
        const game = {
            money: 100,
            inventory: [],
            stats: { hunger: 100, energy: 100, hygiene: 100, fun: 100 },
            time: { day: 0, hour: 8, minute: 0 },
            days: ['Poniedzia≈Çek', 'Wtorek', '≈öroda', 'Czwartek', 'PiƒÖtek', 'Sobota', 'Niedziela'],
            
            init() {
                this.startTick();
                ui.renderShop();
                ui.update();
                ui.initTheme();
            },

            startTick() {
                setInterval(() => {
                    this.tickTime();
                    this.drainStats();
                    ui.update();
                }, 1000);
            },

            tickTime() {
                this.time.minute += 10;
                if(this.time.minute >= 60) { this.time.minute = 0; this.time.hour++; }
                if(this.time.hour >= 24) { this.time.hour = 0; this.time.day = (this.time.day + 1) % 7; }
            },

            drainStats() {
                this.stats.hunger = Math.max(0, this.stats.hunger - 0.5);
                this.stats.energy = Math.max(0, this.stats.energy - 0.3);
                this.stats.hygiene = Math.max(0, this.stats.hygiene - 0.2);
                this.stats.fun = Math.max(0, this.stats.fun - 0.4);
                if (this.stats.hunger < 20 || this.stats.energy < 20) ui.showBubble("Jestem wyko≈Ñczony...");
            },

            performAction(type) {
                Sound.click();
                let msg = "";
                switch(type) {
                    case 'eat':
                        if (this.money >= 10) { this.stats.hunger = Math.min(100, this.stats.hunger + 30); this.money -= 10; msg = "Mniam! üçï"; ui.animateSprite('bounce'); }
                        else { msg = "Brak kasy!"; Sound.sad(); }
                        break;
                    case 'sleep':
                        this.stats.energy = Math.min(100, this.stats.energy + 40); msg = "Zzz... üí§"; ui.animateSprite('sleep');
                        break;
                    case 'shower':
                        this.stats.hygiene = Math.min(100, this.stats.hygiene + 50); msg = "Od≈õwie≈ºony! üöø";
                        break;
                    case 'work':
                        if (this.stats.energy > 20) {
                            const gain = 50 + (this.inventory.includes('pc') ? 25 : 0);
                            this.money += gain; this.stats.energy -= 20; this.stats.hygiene -= 10; msg = `Zarobi≈Çem ¬ß${gain}!`; ui.animateSprite('work');
                        } else { msg = "Zbyt zmƒôczony!"; Sound.sad(); }
                        break;
                }
                ui.showBubble(msg);
                ui.update();
            },

            buyItem(itemId) {
                const item = SHOP_ITEMS.find(i => i.id === itemId);
                if (this.money >= item.price && !this.inventory.includes(itemId)) {
                    this.money -= item.price; this.inventory.push(itemId);
                    Sound.buy(); ui.renderInventory(); ui.renderShop(); ui.update();
                    ui.showBubble(`Kupi≈Çem ${item.name}!`);
                } else if (this.inventory.includes(itemId)) { ui.showBubble("Ju≈º to mam."); }
                else { ui.showBubble("Nie staƒá mnie..."); Sound.sad(); }
            }
        };

        // UI Controller
        const ui = {
            initTheme() {
                const savedTheme = localStorage.getItem('simlife-theme');
                if (savedTheme === 'light') {
                    document.body.classList.remove('dark');
                } else {
                    document.body.classList.add('dark');
                }
                this.updateThemeIcon();
            },

            toggleTheme() {
                document.body.classList.toggle('dark');
                const isDark = document.body.classList.contains('dark');
                localStorage.setItem('simlife-theme', isDark ? 'dark' : 'light');
                this.updateThemeIcon();
                Sound.click();
            },

            updateThemeIcon() {
                const icon = document.getElementById('theme-icon');
                const isDark = document.body.classList.contains('dark');
                icon.innerHTML = isDark 
                    ? '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />'
                    : '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />';
            },

            update() {
                document.getElementById('bar-hunger').style.width = game.stats.hunger + '%';
                document.getElementById('bar-energy').style.width = game.stats.energy + '%';
                document.getElementById('bar-hygiene').style.width = game.stats.hygiene + '%';
                document.getElementById('bar-fun').style.width = game.stats.fun + '%';
                document.getElementById('val-hunger').innerText = Math.floor(game.stats.hunger) + '%';
                document.getElementById('val-energy').innerText = Math.floor(game.stats.energy) + '%';
                document.getElementById('val-hygiene').innerText = Math.floor(game.stats.hygiene) + '%';
                document.getElementById('val-fun').innerText = Math.floor(game.stats.fun) + '%';
                document.getElementById('money-display').innerText = game.money + ' ¬ß';
                const h = game.time.hour.toString().padStart(2, '0');
                const m = game.time.minute.toString().padStart(2, '0');
                document.getElementById('time-display').innerText = `${game.days[game.time.day]}, ${h}:${m}`;
                this.updateBarColor('bar-hunger', game.stats.hunger);
                this.updateBarColor('bar-energy', game.stats.energy);
            },

            updateBarColor(id, val) {
                const el = document.getElementById(id);
                if (val < 20) el.className = 'stat-bar bg-red-500 rounded-full';
                else if (val < 50) el.className = 'stat-bar bg-orange-400 rounded-full';
                else {
                    const base = id === 'bar-hunger' ? 'bg-orange-400' : id === 'bar-energy' ? 'bg-yellow-400' : id === 'bar-hygiene' ? 'bg-blue-400' : 'bg-pink-400';
                    el.className = `stat-bar ${base} rounded-full`;
                }
            },

            showBubble(text) {
                const bubble = document.getElementById('speech-bubble');
                document.getElementById('bubble-text').innerText = text;
                bubble.style.opacity = '1';
                setTimeout(() => bubble.style.opacity = '0', 2000);
            },

            animateSprite(type) {
                const sprite = document.getElementById('character-sprite');
                sprite.className = 'text-8xl mb-4 transition-all duration-300 transform';
                if(type === 'bounce') sprite.classList.add('scale-125', '-translate-y-4');
                if(type === 'sleep') sprite.classList.add('rotate-90', 'opacity-50');
                if(type === 'work') sprite.classList.add('skew-x-12');
                setTimeout(() => sprite.className = 'text-8xl mb-4 transition-all duration-500 transform scale-100', 1000);
            },

            toggleShop() {
                document.getElementById('shop-modal').classList.toggle('hidden');
                Sound.click();
            },

            renderShop() {
                const container = document.getElementById('shop-items');
                container.innerHTML = SHOP_ITEMS.map(item => {
                    const owned = game.inventory.includes(item.id);
                    return `
                        <div class="flex items-center justify-between p-4 bg-panel border-2 ${owned ? 'border-green-200 dark:border-green-900/40' : 'border-panel'} rounded-2xl">
                            <div class="flex items-center gap-4">
                                <span class="text-3xl">${item.icon}</span>
                                <div>
                                    <h3 class="font-bold text-main">${item.name}</h3>
                                    <p class="text-xs text-muted">Cena: ¬ß${item.price}</p>
                                </div>
                            </div>
                            <button onclick="game.buyItem('${item.id}')" ${owned ? 'disabled' : ''} class="px-4 py-2 rounded-xl text-sm font-bold ${owned ? 'bg-gray-100 dark:bg-gray-800 text-muted' : 'bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 hover:bg-indigo-200'}">
                                ${owned ? 'Posiadane' : 'Kup'}
                            </button>
                        </div>
                    `;
                }).join('');
            },

            renderInventory() {
                const container = document.getElementById('room-items');
                container.innerHTML = game.inventory.map(id => {
                    const item = SHOP_ITEMS.find(i => i.id === id);
                    return `<div class="text-6xl grayscale-0 opacity-100 drop-shadow-md animate-bounce" title="${item.name}">${item.icon}</div>`;
                }).join('');
                container.classList.remove('opacity-40');
            }
        };

        // Event Listeners
        document.getElementById('theme-toggle').onclick = () => ui.toggleTheme();
        
        let musicPlaying = false;
        document.getElementById('audio-toggle').onclick = () => {
            const music = document.getElementById('bg-music');
            if(!musicPlaying) {
                music.play().catch(() => {});
                document.getElementById('music-on').classList.add('text-indigo-600');
                Sound.happy();
            } else {
                music.pause();
                document.getElementById('music-on').classList.remove('text-indigo-600');
            }
            musicPlaying = !musicPlaying;
        };

        window.onload = () => {
            game.init();
            document.body.addEventListener('click', () => Sound.init(), { once: true });
        };
    </script>
</body>
</html>